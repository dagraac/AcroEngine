#include "AObject.h"
#include "AVariable.h"
#include "AClassGenerated.h"


/////////////////////////////////////////////////////////////////////////////
// @ 생성.
/////////////////////////////////////////////////////////////////////////////
AcroEngine::AObject::AObject()
{
    m_ID = 0;
    m_ReferenceCount = 0;
}

/////////////////////////////////////////////////////////////////////////////
// @ 소멸.
/////////////////////////////////////////////////////////////////////////////
AcroEngine::AObject::~AObject()
{

}

/////////////////////////////////////////////////////////////////////////////
// @ 레퍼런스 카운트 증가.
/////////////////////////////////////////////////////////////////////////////
void AcroEngine::AObject::IncreaseReference(AObject* AObjectImpl)
{
    if (AObjectImpl != nullptr && !AObjectImpl->m_IsDestroyed)
    {
        ++AObjectImpl->m_ReferenceCount;
    }
}

/////////////////////////////////////////////////////////////////////////////
// @ 레퍼런스 카운트 감소.
/////////////////////////////////////////////////////////////////////////////
void AcroEngine::AObject::DecreaseReference(AObject* AObjectImpl)
{
    if (AObjectImpl != nullptr && !AObjectImpl->m_IsDestroyed)
    {
        --AObjectImpl->m_ReferenceCount;

        if (AObjectImpl->m_ReferenceCount <= 0)
        {
            AObjectImpl->m_IsDestroyed = true;
        }
    }
}

/////////////////////////////////////////////////////////////////////////////
// @
/////////////////////////////////////////////////////////////////////////////
AcroEngine::AString AcroEngine::AObject::ToString()
{
    return AString();
}

/////////////////////////////////////////////////////////////////////////////
// @ 생성.
/////////////////////////////////////////////////////////////////////////////
AcroEngine::AObject* AcroEngine::AObject::Instantiate(AcroEngine::AType* Class)
{
    return nullptr;
}

/////////////////////////////////////////////////////////////////////////////
// @ 파괴.
/////////////////////////////////////////////////////////////////////////////
void AcroEngine::AObject::Destroy(AcroEngine::AObject* AObjectImpl)
{
    if (AObjectImpl != nullptr && !AObjectImpl->m_IsDestroyed)
    {
        AObjectImpl->m_ReferenceCount = 0;
        AObjectImpl->m_IsDestroyed = true;
    }
}


/////////////////////////////////////////////////////////////////////////////
// @ 즉시 파괴.
/////////////////////////////////////////////////////////////////////////////
void AcroEngine::AObject::DestroyImmediate(AcroEngine::AObject* AObjectImpl)
{
    if (AObjectImpl != nullptr)
    {
        delete AObjectImpl;
        AObjectImpl = nullptr;
    }
}

///////////////////////////////////////////////////////////////////////////////
//// @
///////////////////////////////////////////////////////////////////////////////
//AcroEngine::AType* AcroEngine::AObject::GetType()
//{
//    //AClassGenerated::GetTypeName();
//    return nullptr;
//}